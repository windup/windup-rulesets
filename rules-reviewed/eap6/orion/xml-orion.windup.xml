<?xml version="1.0"?>
<ruleset xmlns="http://windup.jboss.org/schema/jboss-ruleset" id="xml-orion"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://windup.jboss.org/schema/jboss-ruleset http://windup.jboss.org/schema/jboss-ruleset/windup-jboss-ruleset.xsd">

     <metadata>
        <description>
            This ruleset provides analysis of Orion proprietary xml files that may require individual
            attention when migrating to JBoss EAP 6+.
        </description>
        <dependencies>
            <addon id="org.jboss.windup.rules,windup-rules-xml,2.3.0.Final" />
        </dependencies>
        <sourceTechnology id="orion" />
        <targetTechnology id="eap" versionRange="[6,)" />
        <tag>web-app</tag>
        <tag>orion</tag>
    </metadata>

    <rules>
        <rule id="xml-orion-01000">
            <when>
                <xmlfile as="default" matches="/orion-ejb-jar">
                </xmlfile>
            </when>
            <perform>
                <iteration>
                    <classification issue-display-mode="all" title="Oracle Application Platform EJB Descriptor" effort="3" category-id="mandatory">
                        <description> Orion specific ejb configuration file used to configure EJBs, map them to jndi names etc.</description>
                        <link
                                href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/development_guide/#jboss-ejb3xml_Deployment_Descriptor_Reference"
                                title="JBoss EAP 6 - jboss-ejb3.xml Deployment Descriptor Reference"/>
                        <link
                                href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.1/html-single/developing_ejb_applications/#jboss_ejb3_xml_deployment_descriptor_reference"
                                title="JBoss EAP 7 - jboss-ejb3.xml Deployment Descriptor Reference"/>
                        <tag>configuration</tag>
                        <tag>orion</tag>
                    </classification>
                </iteration>
            </perform>
        </rule>
        <rule id="xml-orion-02000">
            <when>
                <xmlfile as="default" matches="/orion-web-app">
                </xmlfile>
            </when>
            <perform>
                <iteration>
                    <classification issue-display-mode="all" title="Oracle Application Platform Web Descriptor" effort="3" category-id="mandatory">
                        <description> Oracle Application Platform Web Descriptor configuriation is defined in files by convention named global-web-application.xml and orion-web.xml. It is Orion specific configuration file that besides supporting the standard web.xml features also adds additional support for featuers like buffering, servlet chaining, locales, virtual directories. This file is not supported in JBoss EAP 6 and needs to be migrated to web.xml or JBoss-specific jboss-web.xml</description>
                        <link href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/html/Security_Guide/jboss-webxml_Configuration_Reference.html" title="JBoss EAP web descriptor"/>
                        <tag>configuration</tag>
                        <tag>orion</tag>
                    </classification>
                </iteration>
            </perform>
        </rule>
        <rule id="xml-orion-03000">
            <when>
                <xmlfile as="default" matches="/orion-application">
                </xmlfile>
            </when>
            <perform>
                <iteration>
                    <classification issue-display-mode="all" title="Oracle Application EAR configuration file" effort="3" category-id="optional">
                        <description> Orion-application file is an orion specific EAR configuration file used to configure default data sources for CMP beans, security user manager, jndi authorization etc. This file may have been generated by Orion.</description>
                        <link href="http://www.jboss.org/schema/jbossas/jboss-app_7_0.xsd" title="JBoss application configuration xsd file"/>
                        <tag>configuration</tag>
                        <tag>orion</tag>
                    </classification>
                </iteration>
            </perform>
        </rule>
    </rules>
</ruleset>
