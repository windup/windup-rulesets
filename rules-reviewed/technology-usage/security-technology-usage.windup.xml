<?xml version="1.0"?>
<ruleset id="technology-usage-security" xmlns="http://windup.jboss.org/schema/jboss-ruleset" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://windup.jboss.org/schema/jboss-ruleset http://windup.jboss.org/schema/jboss-ruleset/windup-jboss-ruleset.xsd">
    <metadata>
        <description>
            This ruleset provides statistical summaries of the security related items in the input application (eg, security realms).
        </description>
        <dependencies>
            <addon id="org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final" />
            <addon id="org.jboss.windup.rules,windup-rules-java,3.0.0.Final" />
        </dependencies>
        <phase>PostMigrationRulesPhase</phase>
    </metadata>
    <rules>
        <rule id="technology-usage-security-01000">
            <when>
                <or>
                    <xmlfile matches="//*[local-name() = 'login-config']/*[local-name() = 'realm-name']"
                            in="web.xml"/>
                    <xmlfile matches="//*[local-name() = 'login-config']/*[local-name() = 'realm']"
                            in="{*}ejb-jar.xml"/>
                    <javaclass references="javax.annotation.security.{*}">
                        <location>ANNOTATION</location>
                    </javaclass>
                </or>
            </when>
            <perform>
                <technology-identified name="Security Realm">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Java EE"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01100">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Spring Security (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Spring Security">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01200">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Apache Shiro (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Shiro">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01300">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Hdiv (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Hdiv">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01400">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">OACC (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="OACC">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01500">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">PicketLink (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="PicketLink">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01600">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">PicketBox (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="PicketBox">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01700">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Keyczar (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Keyczar">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01800">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">XACML (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="XACML">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-01900">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">SAML (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="SAML">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02000">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Bouncy Castle (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Bouncy Castle">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02100">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Jasypt (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Jasypt">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02200">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Apache Santuario (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Santuario">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02300">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">SSL (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="SSL">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02400">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Vlad (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Vlad">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02500">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">Apache Commons Validator (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="Apache Commons Validator">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02600">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">OWASP ESAPI (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="OWASP ESAPI">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02700">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">WSS4J (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="WSS4J">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02800">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">OpenSAML (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="OpenSAML">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-02900">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">OTR4J (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="OTR4J">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-03000">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">OWASP CSRF Guard (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="OWASP CSRF Guard">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
        <rule id="technology-usage-security-03100">
            <when>
                <graph-query discriminator="TechnologyTagModel">
                    <property name="name">OAUTH (embedded)</property>
                </graph-query>
            </when>
            <perform>
                <technology-identified name="OAUTH">
                    <tag name="Sustain"/>
                    <tag name="Security"/>
                    <tag name="Embedded"/>
                </technology-identified>
            </perform>
        </rule>
    </rules>
</ruleset>
